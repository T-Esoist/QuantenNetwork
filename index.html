<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>T-ESOIST | Intelligent Bridge</title>
    <script src="https://unpkg.com/html5-qrcode"></script>
    <style>
        body { background: #000; color: #00f2ff; font-family: monospace; padding: 15px; text-align: center; }
        .bridge-core { border: 2px solid #00f2ff; padding: 20px; background: rgba(0,242,255,0.05); border-radius: 15px; }
        .pulse { animation: blink 1.5s infinite; color: #00ff00; }
        @keyframes blink { 0% { opacity: 0.3; } 50% { opacity: 1; } 100% { opacity: 0.3; } }
        .field { width: 100%; background: #000; border: 1px solid #333; color: #fff; padding: 12px; margin: 5px 0; border-radius: 5px; }
        .btn-active { background: #00f2ff; color: #000; padding: 15px; width: 100%; border: none; font-weight: bold; cursor: pointer; }
    </style>
</head>
<body>
    <div class="bridge-core">
        <h2 style="font-size: 14px;">INTELLIGENT BRIDGE v85.0</h2>
        <div id="ai-status" class="pulse">SCANNING FOR BARRIERS...</div>
        
        <button class="btn-active" onclick="document.getElementById('file-in').click()">GALERIE-BRÜCKE SCHLAGEN</button>
        <input type="file" id="file-in" style="display:none" accept="image/*" onchange="intelligentScan(event)">
        
        <div id="bridge-output" style="margin-top:20px;">
            <input type="text" id="rec-field" class="field" placeholder="Ziel-Empfänger (Autofill)">
            <input type="number" id="amt-field" class="field" placeholder="Euro-Betrag (Autofill)">
            <button class="btn-active" style="background:#ff0055; color:#fff;" onclick="finalConfirm()">TRANSFAKTION ABSCHLIESSEN</button>
        </div>
    </div>

    <script>
        const PHI = 1.61803398875;
        function intelligentScan(event) {
            const file = event.target.files[0];
            const status = document.getElementById('ai-status');
            status.innerText = "DURCHBRECHE BARRIEREN...";
            status.style.color = "#ffaa00";

            Html5Qrcode.scanImage(file, { fps: 10 })
                .then(data => {
                    status.innerText = "BRÜCKE GEFUNDEN: DATEN EXTRAHIERT";
                    status.style.color = "#00ff00";
                    
                    // HEURISTIK: Suche Betrag (XX.XX oder XX,XX)
                    const money = data.match(/([0-9]+[.,][0-9]{2})/);
                    if(money) document.getElementById('amt-field').value = money[0].replace(',', '.');
                    
                    // HEURISTIK: Suche Empfänger/Zweck
                    if(data.includes("BCD")) document.getElementById('rec-field').value = "Bank-Gläubiger";
                    else document.getElementById('rec-field').value = "Extrahiertes Ziel";
                })
                .catch(err => {
                    status.innerText = "BARRIERE ZU HOCH: MANUELLE BRÜCKE ERFORDERLICH";
                    status.style.color = "#ff0055";
                });
        }
        function finalConfirm() {
            const amt = document.getElementById('amt-field').value;
            alert("BRÜCKE BESTÄTIGT: " + amt + "€ werden über das Gitter verbucht.");
            location.reload();
        }
    </script>
</body>
</html>