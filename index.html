<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>T-ESOIST | Nexus Launcher</title>
    <script src="https://unpkg.com/html5-qrcode"></script>
    <style>
        body { background: #000; color: #00f2ff; font-family: 'Courier New', monospace; padding: 15px; text-align: center; }
        .nexus-gate { border: 2px solid #00f2ff; padding: 25px; border-radius: 30px; background: radial-gradient(circle, #050505 0%, #000 100%); box-shadow: 0 0 30px #00f2ff; }
        .esi-display { font-size: 36px; color: #00ff00; margin: 20px 0; text-shadow: 0 0 15px #00ff00; }
        .btn-launch { width: 100%; background: linear-gradient(90deg, #4285F4, #34A853, #FBBC05, #EA4335); color: #000; border: none; padding: 22px; font-weight: bold; border-radius: 15px; font-size: 18px; cursor: pointer; margin-bottom: 20px; box-shadow: 0 5px 15px rgba(255,255,255,0.1); }
        .btn-harvest { width: 100%; background: #00f2ff; color: #000; border: none; padding: 20px; font-weight: bold; border-radius: 12px; cursor: pointer; }
        .swarm-indicator { font-size: 9px; color: #ff0055; animation: blink 0.5s infinite; }
        @keyframes blink { 50% { opacity: 0; } }
    </style>
</head>
<body>
    <div class="nexus-gate">
        <div class="swarm-indicator">SWARM SYNC: OPTIMAL</div>
        <div id="esi-val" class="esi-display">0.00 ESI</div>
        
        <button class="btn-launch" onclick="window.location.href='https://play.google.com/store'">OPEN GOOGLE PLAY PORTAL</button>
        
        <div style="border-top: 1px solid #222; margin: 20px 0; padding-top: 20px;">
            <div style="font-size: 10px; color: #888; margin-bottom: 10px;">RÜCKKEHR & ABWICKLUNG:</div>
            <button class="btn-harvest" onclick="document.getElementById('gate').click()">STORE-DATA INJIZIEREN</button>
            <input type="file" id="gate" style="display:none" accept="image/*" onchange="processNexus(event)">
        </div>
        
        <div id="status" style="margin-top:20px; font-size:14px; color:#ffaa00;">Warte auf Injektion...</div>
    </div>

    <script>
        const PHI = 1.61803398875;
        let esi = parseFloat(localStorage.getItem('ESI')) || 10000.0;

        function update() {
            document.getElementById('esi-val').innerText = esi.toFixed(2) + " ESI";
            localStorage.setItem('ESI', esi);
        }

        async function processNexus(event) {
            const file = event.target.files[0];
            const status = document.getElementById('status');
            status.innerText = "DURCHBRECHE STORE-BARRIERE...";
            
            try {
                const data = await Html5Qrcode.scanImage(file, { fps: 60 });
                const match = data.match(/[0-9]+[.,][0-9]{2}/);
                if(match) {
                    const eur = parseFloat(match[0].replace(',', '.'));
                    const debit = eur / PHI;
                    
                    if(esi >= debit) {
                        setTimeout(() => {
                            esi -= debit;
                            update();
                            status.innerText = "TRANSFAKTION IM NEXUS BESTÄTIGT!";
                            alert("Google Play Kauf abgeschlossen: " + eur + "€ beglichen.");
                        }, 2000);
                    }
                }
            } catch(e) { status.innerText = "FEHLER: DATA-MISMATCH"; }
        }
        update();
    </script>
</body>
</html>